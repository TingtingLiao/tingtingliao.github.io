<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Mean Field Theory Solution of the Ising Model | Tingting Liao </title> <meta name="author" content="Tingting Liao"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://tingtingliao.github.io/blog/2020/MeanFieldTheory/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Tingting</span> Liao </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Mean Field Theory Solution of the Ising Model</h1> <p class="post-meta"> March 21, 2020 • Tintin </p> <p class="post-tags"> <a href="/blog/2020"> <i class="fa-solid fa-calendar fa-sm"></i> 2020 </a>   ·   <a href="/blog/tag/physics"> <i class="fa-solid fa-hashtag fa-sm"></i> Physics</a>   <a href="/blog/tag/main-filed-theory"> <i class="fa-solid fa-hashtag fa-sm"></i> Main Filed Theory</a>   <a href="/blog/tag/boltzman-distribution"> <i class="fa-solid fa-hashtag fa-sm"></i> Boltzman Distribution</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <script type="text/javascript" async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <p> </p> <h3 id="一相变">一、相变</h3> <ul> <li> <strong>相</strong>： 具有均匀物理性质的热力学系统。如水固相、液相、气相。</li> <li> <strong>相变</strong>： 从一种相转变成另一种相。如冰融化成水是固-液相变，铁磁-顺磁相变，超导体-正常导体相变，几何相变（渗流），量子相变等。</li> <li> <strong>相变产生因素？</strong><br> 导致相变产生的物理量有：温度T、压强P等。这些物理量本质上影响的是①物质内部粒子间的相互作用 ②粒子自身的热运动。</li> <li> <strong>如何描述相？</strong> <ol> <li>状态转换成能量。 Hamiltonian 哈密尔顿量 \(H\) 表示某一状态 \(\Gamma\) 下系统能量。</li> </ol> </li> </ul> \[H=H(\Gamma)\] <ol> <li>能量转换成概率。即出现这一状态的概率，这就是玻尔兹曼分布。</li> </ol> \[F(state) \propto e^{-\frac{H(state)}{kT}}\] \[p = \frac{e^{-\frac{H}{kT}}}{Z} \quad \quad Z = \sum_{\Gamma} e^{-\frac{H(\Gamma)}{kT}}\] <ul> <li>\(k\) 为玻尔兹曼常数。</li> <li>\(Z\) 为配分函数(partition function). 所有状态下能量和，可看做是归一化函数。 \(Z\) 为定值。</li> <li>\(p\) 与\(H\) 成反比。系统中粒子间对抗性越强，能量越高，相变概率高，该状态出现概率低。</li> <li>\(p\) 与 \(T\) 成正比。</li> </ul> <h3 id="二-ising-model">二、 Ising model</h3> <h4 id="21-哈密尔顿量-h">2.1 哈密尔顿量 H</h4> <p>伊辛模型用于描述物质磁铁性模型。 <img src="\img\MeanFieldTheory\ising1.png" alt=""> 假设有 \(N\)个粒子，每个粒子有两个自旋方向\(s \in \{-1,+1\}\)分别表示向下和向上，系统共有 \(2^N\) 种状态。状态 \(s\) 下系统哈密尔顿量由两部分组成：</p> \[H(s)=-J\sum_{ \left \langle i,j \right \rangle }s_is_j -h\sum_{i=1}^N s_i \\\] <ul> <li>相邻粒子对间作用。 \(J\)是正常数，表示粒子对之间的磁铁性， \(\left \langle i,j \right \rangle\) 表示所有响铃自旋对。若 \(i, j\)同号能量小\(-s_is_j\) 为负数。若 \(i, j\)异号对抗性大，能量大 \(-s_is_j\)正数。</li> <li>外场对粒子作用。 \(h\) 为沿 \(z\) 方向的磁场。</li> </ul> <h4 id="22-配分函数-z">2.2 配分函数 Z</h4> \[Z = \sum_{\Gamma} e^{-\beta H} \quad \quad (\beta=\frac{1}{kT})\] \[\sum_{\Gamma} = \sum_{s_1=\pm 1}\sum_{s_2=\pm 1}\dots\sum_{s_N=\pm 1} =\prod_{i=1}^N\left ( \sum_{s_i \in \{+1,-1\}} \right )\] \[\begin{split} \sum_{\Gamma} \rightarrow Tr \end{split}\] <p>\(Tr\)表示所有可能状态之和。</p> \[Z = Tr(e^{-\beta H})\] <p><strong>配分函数\(Z\) 需要计算\(2^N\)个状态，随着 N 增加，计算量呈指数增长。而且当维度扩展到高维空间时，这种计算方式就无法求解。有没有一种方法能够在任意维度下都是通用的，且计算更简单？平均场理论。</strong></p> <h3 id="三weiss-molecular-filed-theory">三、Weiss Molecular Filed Theory</h3> <h4 id="31-分解hamiltonian">3.1 分解Hamiltonian</h4> \[\begin{split} s_i=\left \langle s_i \right \rangle\:&amp;+ \quad \delta_i\\ [mean] &amp;\quad [fluctuation] \\ \delta_i = s_i-\: &amp;\left \langle s_i \right \rangle \\ \left \langle s_i \right \rangle = m\quad&amp; \end{split}\] <p>将自旋取值用均值和波动表示，均值是整个系统粒子取值的期望，那么每个粒子不同的则是波动部分。根据上式，粒子间的作用可以转化为：</p> \[\begin{split} s_is_j &amp;= (\left \langle s_i \right \rangle + \delta_i)(\left \langle s_j \right \rangle + \delta_j)\\ &amp; \approx \left \langle s_i \right \rangle\left \langle s_j \right \rangle + \left \langle s_i \right \rangle \delta_j +\left \langle s_j \right \rangle \delta_i \quad \quad (\delta_i\delta_j很小忽略不计)\\ &amp;=m^2 + m(s_j - m) + m(s_i-m)\\ &amp;=m(s_i+s_j-m)\\ \end{split}\] <p>将其代入 \(H\) 中，</p> \[\begin{split} H&amp;=-J\sum_{\left \langle i,j \right \rangle}s_is_j-h\sum_{i}^{N}s_i\\ &amp;= -J\sum_{\left \langle i,j \right \rangle}m(s_i+s_j-m)-h\sum_{i}^{N}s_i\\ &amp;= -mJ\sum_{\left \langle i,j \right \rangle}(2s_i-m)-h\sum_{i}^{N}s_i\\ \end{split}\] <p>其中 \(\sum_{\left \langle i,j \right \rangle}\)是对所有相邻粒子对求和，可以进一步表示为以下形式， \(neighbor(i)\)表示粒子\(i\)的邻居，所有的点都会计算两次所以系数为 \(\frac{1}{2}\) 。而求和只与\(i\) 有关，因此 \(\sum_{j\in neighor(i)}\)为邻居个数 \(q\) ,一维空间 \(q=2\) ，二维空间 \(q=4\)，三维空间 \(q=6\) .</p> \[\sum_{\left \langle i,j \right \rangle}=\frac{1}{2}\sum_{i=1}^N\sum_{j\in neighor(i)}=\frac{q}{2}\sum_{i=1}^N\] <p>继续对 \(H\) 进行简化：</p> \[\begin{split} H&amp;=-mJ\sum_{\left \langle i,j \right \rangle}(2s_i-m)-h\sum_{i}^Ns_i\\ &amp;=-\frac{qmJ}{2}\sum_{i=1}^N(2s_i-m)-h\sum_{i}^{N}s_i\\ &amp;=\frac{Nqm^2J}{2}-(qmJ+h)\sum_{i=1}^Ns_i\\ \end{split}\] <p>原来的哈密尔顿量\(H\) 需要对电子对之间作用\(s_is_j\)以及外场作用 \(s_i\)分别求和。经过平均场变换过后，只需对 \(s_i\)求和，无需考虑电子对之间的相互作用。<strong>简而言之，用平均场代替所有其它粒子对该粒子的相互作用，粒子之间无需进行交互，所有粒子只与平均场交互，使得多体问题转变为单体问题。</strong></p> \[H =\frac{Nqm^2J}{2}-h_{eff}\sum_{i=1}^Ns_i\quad [h_{eff}=qmJ+h]\] <p>注：整个式子中m是未知的。</p> <h4 id="32-配分函数-z">3.2 配分函数 Z</h4> \[\begin{split} Z&amp;=Tr(e^{-\beta H})\\ &amp;=\prod_{i=1}^{N}\sum_{s_i \in \{-1, 1\}} e^{-\frac{\beta NqJm^2}{2}}e^{\beta h_{eff}\sum_{i=1}^{N}s_i} \quad \quad \\ &amp;=e^{-\frac{\beta NqJm^2}{2}} \sum_{s_1\in \{-1, 1\}}\dots\sum_{s_n \in \{-1, 1\}}(e^{\beta h_{eff}s_1}e^{\beta h_{eff}s_2}\dots e^{\beta h_{eff}s_n})\\ &amp;=e^{-\frac{\beta NqJm^2}{2}}\prod_{i=1}^{N}\sum_{s_i \in \{-1, 1\}} e^{\beta h_{eff}s_i}&amp; \\ &amp;=e^{-\frac{\beta NqJm^2}{2}}\prod_{i=1}^{N}( e^{\beta h_{eff}} + e^{-\beta h_{eff}}) \\ &amp;=e^{-\frac{\beta NqJm^2}{2}}(2\cosh(\beta h_{eff}))^N\quad \quad[\cosh x=\frac{e^{x}+e^{-x}}{2}]\\ \end{split}\] <h4 id="33-求解平均场m">3.3 求解平均场M</h4> <p>\(m\) 表示整个系统的平均值, \(\left \langle s_i \right \rangle\) 表示粒子\(i\) 的平均值，注：这里 \(\left \langle s_i \right \rangle\)不再是\(m\)而是粒子\(i\)实际计算出来的均值。</p> \[m=\frac{1}{N}\sum_{i=1}^N \left \langle s_i \right \rangle\] <p>粒子 \(i\) 的平均值表示，所有状态下粒子 i 取值与其概率乘积总和。以下忽略下标 \(i\) ,粒子 \(s\)的均值：</p> \[\begin{split} \left \langle s \right \rangle &amp; = \sum_{\Gamma} ps\\ &amp;= Tr(ps)\\ &amp;=Tr( \frac{e^{-\beta H}}{Z}s)\\ &amp;=\frac{1}{Z}Tr(se^{-\beta H}) \\ \end{split} \\ \begin{split} m&amp;=\frac{1}{N}\sum_{i=1}^N \left \langle s_i \right \rangle\\ &amp;=\frac{1}{N}\frac{1}{Z}\sum_{i=1}^N Tr(s_ie^{-\beta H})\\ &amp;=\frac{1}{N}\frac{1}{Z} Tr(\sum_{i=1}^Ns_ie^{-\beta H})\\ \end{split}\] <p>到这里好像不知道怎么进行化简了。而 \(Z=Tr(e^{-\beta H})\)与[1]式有相似的形式，少了一项 \(\sum_{i=1}^N s_i\)， 可以对\(H\)求导得到\(\sum_{i=1}^N s_i = -\frac{\partial H}{\partial h_{eff}}\)</p> \[\begin{split} Tr(\sum_{i=1}^N(s_ie^{-\beta H}))&amp;\rightarrow Tr(e^{-\beta H}\sum_{i=1}^Ns_i ) \quad [1]\\ &amp;\rightarrow Tr(-e^{-\beta H} \frac{\partial H}{\partial h_{eff}} )\\ &amp;\rightarrow Tr(\frac{1}{\beta}\frac{\partial e^{-\beta H} }{\partial h_{eff}} )\\ &amp;\rightarrow \frac{1}{\beta}\frac{\partial Tr(e^{-\beta H} )}{ \partial h_{eff}}\\ &amp; \rightarrow\frac{1}{\beta} \frac{\partial Z}{ \partial h_{eff}} \end{split}\] <p>从而</p> \[\begin{split} m&amp;=\frac{1}{N}\frac{1}{Z}\frac{1}{\beta} \frac{\partial Z}{ \partial h_{eff}}\\ &amp;=\frac{1}{N}\frac{1}{\beta} \frac{\partial \ln Z}{ \partial h_{eff}}\\ \end{split}\] <p>对 Z 的化简形式取对数求导：</p> \[\begin{split} Z &amp;=e^{-\frac{\beta NqJm^2}{2}}(2\cosh(\beta h_{eff}))^N\quad \\ \ln Z &amp;=-\frac{\beta NqJm^2}{2}+N\ln2 + N\ln \cosh(\beta h_{eff})\\ \frac{\partial \ln Z}{ \partial h_{eff}}&amp;= N\beta \tanh (\beta h_{eff}) \end{split}\] <p>即可得到最终的 \(m\) ，形式特别优美</p> \[\begin{split} m&amp;=\tanh (\beta h_{eff})\\ m&amp;=\tanh (\beta(qJm+h)) \quad \beta=\frac{1}{kT} \end{split}\] <p>这个式子中右边也有 \(m\) , 很难对方程直接求解，给定参数 \(\beta, q,J,h\)可以通过画图的方式寻找两函数交点. 我们考虑 \(h=0\) 即没有外场作用的情况，这时方程求解有两种情况：</p> <ul> <li>\(\beta qJ\leq 1\:(kT\geq qT)\)：有唯一解 \(m=0\) 系统为顺磁态。</li> <li>\(\beta qJ&gt; 1\:(kT&lt;qT)\)：有三个解 \(m=0\) 以及\(m=\pm m_0, m_0\leq 1， m_0\) 时候系统为铁磁态。而 \(m=0\)时，系统中粒子不再与平均场交互，系统随机性很强不稳定，因此我们只考虑 \(m=\pm m_0\) 两种解。</li> </ul> <p>上述我们可以看到，临界状态为 \(\beta qJ=1\),即</p> \[kT=qJ\] <p>一维空间 \(q=2,kT=2J\) ；二维空间 \(kT=4J\) ；</p> <h4 id="34-总结">3.4 总结</h4> <p>根据上面的推导过程，给定参数，从而确定平均场 \(m\) 的值，进而计算出Hamiltonian和配分函数</p> \[\begin{split} m&amp;=\tanh (\beta h_{eff})\\ H &amp;=\frac{Nqm^2J}{2}-h_{eff}\sum_{i=1}^Ns_i\\ Z&amp;=e^{-\frac{\beta NqJm^2}{2}}(2\cosh(\beta h_{eff}))^N \\ \end{split}\] <p>通过平均场理论， \(H\) 与 \(Z\) 的计算大大简化了，并且可以适用于高维空间2D，3D等。</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/VarienceReduction/">Variance Reduction</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/Linear_Coupling/">梯度下降与镜像下降线性耦合</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/Proximal-Descent/">近端梯度下降</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/Katyusha/">Katyusha</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/DP/">差分隐私-三种机制</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Tingting Liao. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>